{% extends 'base.html' %}

{% block title %}Mijn Chats - KLUSKOMPAS{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4" style="color: #10246B;">Mijn Chats</h2>

    <div class="row">
        <!-- Aangeboden Klussen -->
        <div class="col-md-6">
            <h3 class="text-center mb-3" style="color: #10246B;">Aangeboden Klussen</h3>
            {% for klus in klussen %}
                {% if klus.type == 'aangeboden' %}
                    <div class="card mb-4 shadow-sm">
                        <div class="card-body">
                            <h4 class="card-title" style="color: #10246B;">{{ klus.naam }} ({{ klus.status }})</h4>
                            <p class="text-muted mb-2"><strong>Klusnaam:</strong> {{ klus.naam }}</p>
                            <p class="text-muted mb-2"><strong>Naam:</strong> {{ klus.other_person_name }}</p>

                            {% if klus.berichten %}
                                <p><strong>Aantal berichten:</strong> {{ klus.berichten|length }}</p>
                                <p class="text-muted"><strong>Laatste bericht:</strong> 
                                    <span class="chat-preview">
                                        {{ klus.berichten[0].inhoud[:50] }}
                                    </span>...
                                </p>
                            {% else %}
                                <p class="text-muted">Er zijn nog geen berichten.</p>
                            {% endif %}

                            <a href="{{ url_for('chat.chat_page', klusnummer=klus.klusnummer) }}" 
                               class="btn btn-primary mt-2">Bekijk Chat</a>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>

        <!-- Gezochte Klussen -->
        <div class="col-md-6">
            <h3 class="text-center mb-3" style="color: #10246B;">Gezochte Klussen</h3>
            {% for klus in klussen %}
                {% if klus.type == 'gezocht' %}
                    <div class="card mb-4 shadow-sm">
                        <div class="card-body">
                            <h4 class="card-title" style="color: #10246B;">{{ klus.naam }} ({{ klus.status }})</h4>
                            <p class="text-muted mb-2"><strong>Klusnaam:</strong> {{ klus.naam }}</p>
                            <p class="text-muted mb-2"><strong>Naam:</strong> {{ klus.other_person_name }}</p>

                            {% if klus.berichten %}
                                <p><strong>Aantal berichten:</strong> {{ klus.berichten|length }}</p>
                                <p class="text-muted"><strong>Laatste bericht:</strong> 
                                    <span class="chat-preview">
                                        {{ klus.berichten[0].inhoud[:50] }}
                                    </span>...
                                </p>
                            {% else %}
                                <p class="text-muted">Er zijn nog geen berichten.</p>
                            {% endif %}

                            <a href="{{ url_for('chat.chat_page', klusnummer=klus.klusnummer) }}" 
                               class="btn btn-primary mt-2">Bekijk Chat</a>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>
</div>

<!-- Terugknop -->
<div class="back">
    <a href="{{ url_for('main.dashboard') }}">
        <img src="{{ url_for('static', filename='images/terug.png') }}" alt="Terug" style="width: 80px;">
    </a>
</div>

<style>
    .card {
        border: none;
        border-radius: 8px;
        background: #ffffff;
        transition: transform 0.2s ease;
    }

    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .btn-primary {
        background-color: #10246B;
        border: none;
    }

    .btn-primary:hover {
        background-color: #0e1f4a;
    }

    h3, h4 {
        color: #10246B;
    }

    .chat-preview {
        display: inline-block;
        max-width: 100%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .back {
        position: fixed;
        bottom: 20px;
        left: 20px;
    }
</style>
{% endblock %}
